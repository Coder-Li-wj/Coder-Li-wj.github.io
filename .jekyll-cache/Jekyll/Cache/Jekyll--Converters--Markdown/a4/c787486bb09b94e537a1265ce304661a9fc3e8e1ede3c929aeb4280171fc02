I"“-<h2 id="bufferçš„åŸºæœ¬æ“ä½œ">Bufferçš„åŸºæœ¬æ“ä½œ</h2>
<h3 id="bufferå¯¹è±¡æ˜¯nodeå¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ä¸€ä¸ªæ¥å£å®ƒæ˜¯nodeåŸç”Ÿæä¾›çš„å…¨å±€å¯¹è±¡å¯ä»¥ç›´æ¥ä½¿ç”¨ä¸éœ€è¦requirebuffer">Bufferå¯¹è±¡æ˜¯Nodeå¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ä¸€ä¸ªæ¥å£ã€‚å®ƒæ˜¯NodeåŸç”Ÿæä¾›çš„å…¨å±€å¯¹è±¡ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œä¸éœ€è¦require(â€˜bufferâ€™)</h3>

<h5 id="å®ä¾‹åŒ–bufferå¯¹è±¡">å®ä¾‹åŒ–Bufferå¯¹è±¡</h5>
<ol>
  <li><strong>Buffer.alloc(size[, fill[, encoding]])ï¼š</strong>è¿”å›ä¸€ä¸ªæŒ‡å®šå¤§å°çš„ Buffer å®ä¾‹ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½® fillï¼Œåˆ™é»˜è®¤å¡«æ»¡ 0
    <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="c1">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 5ã€ä¸”ç”¨ 0 å¡«å……çš„ Bufferã€‚</span>
<span class="kd">let</span> <span class="nx">buf</span> <span class="o">=</span> <span class="nx">Buffer</span><span class="p">.</span><span class="nx">alloc</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">buf</span><span class="p">)</span><span class="c1">//ç»“æœï¼š&lt;Buffer 00 00 00 00 00&gt;</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li><strong>Bufffer.from(string[, encoding])ï¼š</strong> è¿”å›ä¸€ä¸ªè¢« string çš„å€¼åˆå§‹åŒ–çš„æ–°çš„ Buffer å®ä¾‹
    <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="kd">let</span> <span class="nx">buf</span> <span class="o">=</span> <span class="nx">Buffer</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="dl">'</span><span class="s1">hello</span><span class="dl">'</span><span class="p">)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">buf</span><span class="p">)</span><span class="c1">//ç»“æœï¼š&lt;Buffer 68 65 6c 6c 6f&gt;</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li><strong>Bufffer.from(array)ï¼š</strong> è¿”å›ä¸€ä¸ªè¢« array çš„å€¼åˆå§‹åŒ–çš„æ–°çš„ Buffer å®ä¾‹ï¼ˆä¼ å…¥çš„ array çš„å…ƒç´ åªèƒ½æ˜¯æ•°å­—ï¼Œä¸ç„¶å°±ä¼šè‡ªåŠ¨è¢« 0 è¦†ç›–ï¼‰
    <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="c1">//åˆ›å»ºä¸€ä¸ªæ–°çš„åŒ…å«utf-8å­—èŠ‚çš„ç¼“å†²åŒº</span>
<span class="kd">const</span> <span class="nx">buf</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Buffer</span><span class="p">([</span><span class="mh">0x62</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x72</span><span class="p">]);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">buf</span><span class="p">)</span><span class="c1">//ç»“æœï¼šbuffer</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ol>

<h5 id="åŠŸèƒ½æ–¹æ³•">åŠŸèƒ½æ–¹æ³•</h5>
<ol>
  <li><strong>Buffer.isEncoding()ï¼š</strong>åˆ¤æ–­æ˜¯å¦æ”¯æŒè¯¥ç¼–ç ï¼Œå¦‚æœæ”¯æŒè¿”å›trueï¼Œå¦åˆ™è¿”å›false
    <blockquote>
      <p>ç›®å‰æ”¯æŒçš„ç¼–ç ï¼šâ€™asciiâ€™,â€™utf8â€™,â€™utf16leâ€™,â€™ucs2â€™,â€™base64â€™,â€™latin1â€™,â€™binaryâ€™,â€™hexâ€™</p>
    </blockquote>
  </li>
  <li><strong>Buffer.isBuffer()ï¼š</strong>åˆ¤æ–­æ˜¯å¦ä¸ºBufferï¼Œå¦‚æœæ˜¯è¿”å›trueï¼Œå¦åˆ™è¿”å›false</li>
  <li><strong>Buffer.byteLength()ï¼š</strong>è¿”å›æŒ‡å®šç¼–ç çš„å­—èŠ‚é•¿åº¦ï¼Œé»˜è®¤utf-8
    <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="kd">let</span> <span class="nx">buf</span> <span class="o">=</span> <span class="nx">Buffer</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="dl">'</span><span class="s1">ä¸­å›½</span><span class="dl">'</span><span class="p">)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">Buffer</span><span class="p">.</span><span class="nx">byteLength</span><span class="p">(</span><span class="nx">buf</span><span class="p">))</span><span class="c1">//ç»“æœï¼š6 </span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li><strong>Buffer.concat()ï¼š</strong>å°†ä¸€ç»„Bufferå¯¹è±¡åˆå¹¶ä¸ºä¸€ä¸ªBufferå¯¹è±¡
    <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="kd">let</span> <span class="nx">buf1</span> <span class="o">=</span> <span class="nx">Buffer</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="dl">'</span><span class="s1">Tom and</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">let</span> <span class="nx">buf2</span> <span class="o">=</span> <span class="nx">Buffer</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="dl">'</span><span class="s1">Jerry</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">let</span> <span class="nx">buf3</span> <span class="o">=</span> <span class="nx">Buffer</span><span class="p">.</span><span class="nx">concat</span><span class="p">([</span><span class="nx">buf1</span><span class="p">,</span> <span class="nx">buf2</span><span class="p">])</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">buf3</span><span class="p">.</span><span class="nx">toString</span><span class="p">())</span><span class="c1">//ç»“æœï¼šTom and Jerry</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ol>

<h5 id="å®ä¾‹æ–¹æ³•">å®ä¾‹æ–¹æ³•</h5>
<ol>
  <li><strong>buf.write(string[, offset[, length]][, encoding])</strong>ï¼šå‘bufferå¯¹è±¡å†™å…¥å†…å®¹
    <blockquote>
      <p>å¯é€‰å‚æ•°ï¼š<br />
offsetï¼šä»å“ªä¸ªä½ç½®å¼€å§‹å†™ï¼Œé»˜è®¤æ˜¯0<br />
lengthï¼šå†™å…¥å¤šå°‘ä¸ªå­—èŠ‚ï¼Œé»˜è®¤æ˜¯buf.length<br />
encoding:ç¼–ç ç±»å‹ï¼Œé»˜è®¤æ˜¯â€™utf8â€™</p>
      <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="kd">let</span> <span class="nx">buf</span> <span class="o">=</span> <span class="nx">Buffer</span><span class="p">.</span><span class="nx">alloc</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="nx">buf</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="dl">'</span><span class="s1">hello</span><span class="dl">'</span><span class="p">)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">buf</span><span class="p">)</span><span class="c1">//ç»“æœï¼š&lt;Buffer 68 65 6c 6c 6f&gt;</span>
</pre></td></tr></tbody></table></code></pre></div>      </div>
    </blockquote>
  </li>
  <li><strong>buf.slice([start[, end]])ï¼š</strong>æˆªå–æ–°çš„bufferå¯¹è±¡
    <blockquote>
      <p>å¯é€‰å‚æ•°ï¼š<br />
startï¼šæ–° Buffer å¼€å§‹çš„ä½ç½®ã€‚é»˜è®¤å€¼: 0<br />
endï¼šæ–° Buffer ç»“æŸçš„ä½ç½®ï¼ˆä¸åŒ…å«ï¼‰ã€‚é»˜è®¤å€¼: buf.lengthã€‚</p>
      <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="kd">let</span> <span class="nx">buf</span> <span class="o">=</span> <span class="nx">Buffer</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="dl">'</span><span class="s1">hello</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">let</span> <span class="nx">buf1</span> <span class="o">=</span> <span class="nx">buf</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">buf1</span><span class="p">)</span><span class="c1">//ç»“æœï¼šll</span>
</pre></td></tr></tbody></table></code></pre></div>      </div>
    </blockquote>
  </li>
  <li><strong>buf.toString([encoding[, start[, end]]])ï¼š</strong>æŠŠbufferå¯¹è±¡è½¬æˆå­—ç¬¦ä¸²
    <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="kd">let</span> <span class="nx">buf</span> <span class="o">=</span> <span class="nx">Buffer</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="dl">'</span><span class="s1">hello</span><span class="dl">'</span><span class="p">)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">buf</span><span class="p">.</span><span class="nx">toString</span><span class="p">())</span><span class="c1">//ç»“æœï¼šhello</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li><strong>buf.toJson([encoding[, start[, end]]])ï¼š</strong>æŠŠbufferå¯¹è±¡è½¬æˆjsonå½¢å¼çš„å­—ç¬¦ä¸²ï¼ˆtoJsonæ–¹æ³•ä¸éœ€è¦æ˜¾å¼è°ƒç”¨ï¼Œå½“JSON.stringifyæ–¹æ³•è°ƒç”¨çš„æ—¶å€™ä¼šè‡ªåŠ¨è°ƒç”¨toJSONæ–¹æ³•ï¼‰
    <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="kd">let</span> <span class="nx">buf</span> <span class="o">=</span> <span class="nx">Buffer</span><span class="p">.</span><span class="k">from</span><span class="p">([</span><span class="mh">0x1</span><span class="p">,</span> <span class="mh">0x2</span><span class="p">,</span> <span class="mh">0x3</span><span class="p">,</span> <span class="mh">0x4</span><span class="p">,</span> <span class="mh">0x5</span><span class="p">]);</span>
<span class="kd">let</span> <span class="nx">json</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">buf</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">json</span><span class="p">);</span><span class="c1">// ç»“æœ: {"type":"Buffer","data":[1,2,3,4,5]}</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ol>
:ET